<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.geometry.*?>

<BorderPane xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.planify.planifyplus.controller.InicioController"
            style="-fx-background-color: #F5F8FB;">

    <!-- ================= HEADER (UNA SOLA LÃNEA, SIN SCROLL) ================= -->
    <top>
        <GridPane style="-fx-padding: 22; -fx-background-color: #F2F4F8;"
                  hgap="14"
                  vgap="0"
                  alignment="CENTER_LEFT">

            <columnConstraints>
                <!-- IZQUIERDA -->
                <ColumnConstraints hgrow="NEVER" minWidth="0"/>
                <!-- CENTRO (se encoge si hace falta) -->
                <ColumnConstraints hgrow="ALWAYS" minWidth="0"/>
                <!-- DERECHA (no baja de lÃ­nea) -->
                <ColumnConstraints hgrow="NEVER" minWidth="0"/>
            </columnConstraints>

            <!-- IZQUIERDA: Logo + nombre -->
            <HBox GridPane.columnIndex="0"
                  alignment="CENTER_LEFT"
                  spacing="12"
                  minHeight="48">

                <ImageView fx:id="logoImage"
                           fitHeight="34" fitWidth="34"
                           preserveRatio="true"
                           pickOnBounds="true"/>

                <Label text="PlanifyPlus"
                       style="-fx-font-size: 24; -fx-font-weight: bold; -fx-text-fill: #1563e2;"/>

                <Label fx:id="lblAdminBadge"
                       text="ðŸ›¡ Admin"
                       style="-fx-background-color: #FEE2E2;
                              -fx-text-fill: #B91C1C;
                              -fx-padding: 4 14 4 14;
                              -fx-background-radius: 16;
                              -fx-font-weight: bold;
                              -fx-font-size: 14;"
                       visible="false"
                       managed="false"/>
            </HBox>

            <!-- CENTRO: buscador + distancia (se encoge, pero NO hace wrap) -->
            <HBox GridPane.columnIndex="1"
                  alignment="CENTER"
                  spacing="12"
                  minWidth="0"
                  minHeight="48">

                <TextField fx:id="searchBar"
                           promptText="Buscar actividades..."
                           style="-fx-font-size: 16;"
                           maxWidth="420"
                           minWidth="140"/>

                <ComboBox fx:id="cmbDistancia"
                          promptText="Todas las distancias"
                          maxWidth="190"
                          minWidth="150"/>
            </HBox>

            <!-- DERECHA: ciudad, usuario, botones (SIEMPRE EN LÃNEA) -->
            <HBox GridPane.columnIndex="2"
                  alignment="CENTER_RIGHT"
                  spacing="10"
                  minHeight="48">

                <Label fx:id="lblCiudad"
                       text="Sevilla"
                       visible="false"
                       managed="true"
                       style="-fx-background-color: #e7eaf3;
                              -fx-padding: 4 18 4 18;
                              -fx-background-radius: 16;
                              -fx-font-size: 15;
                              -fx-font-weight: bold;"
                       textOverrun="CLIP"
                       wrapText="false"/>

                <Label fx:id="lblUser"
                       text="Juan Carlos"
                       visible="false"
                       managed="true"
                       style="-fx-background-color: #1563e2;
                              -fx-text-fill: white;
                              -fx-padding: 6 18 6 18;
                              -fx-background-radius: 16;
                              -fx-font-size: 15;
                              -fx-font-weight: bold;"
                       textOverrun="CLIP"
                       wrapText="false"/>

                <Button fx:id="btnPerfil"
                        text="Mi Perfil"
                        visible="false"
                        managed="true"
                        onAction="#handlePerfil"
                        style="-fx-background-color: #E5E7EB;
                               -fx-text-fill: #222;
                               -fx-background-radius: 15;
                               -fx-font-size: 15;"/>

                <Button fx:id="btnLogout"
                        text="Cerrar sesiÃ³n"
                        visible="false"
                        managed="true"
                        onAction="#handleLogout"
                        style="-fx-background-color: #E5E7EB;
                               -fx-text-fill: #222;
                               -fx-background-radius: 15;
                               -fx-font-size: 15;"/>

                <Button fx:id="btnCrearActividad"
                        text="Crear Actividad"
                        visible="false"
                        managed="true"
                        onAction="#handleCrearActividad"
                        style="-fx-background-color: #1563e2;
                               -fx-text-fill: white;
                               -fx-background-radius: 22;
                               -fx-font-size: 16;
                               -fx-padding: 8 26 8 26;
                               -fx-effect: dropshadow(gaussian, #1563e2, 3, 0.4, 0, 2);"/>

                <Button fx:id="btnRegister"
                        text="Registrarse"
                        managed="true"
                        onAction="#handleRegister"
                        style="-fx-background-color: #60A5FA;
                               -fx-text-fill: white;
                               -fx-background-radius: 22;
                               -fx-font-size: 15;"/>

                <Button fx:id="btnLogin"
                        text="Iniciar sesiÃ³n"
                        managed="true"
                        onAction="#handleLogin"
                        style="-fx-background-color: white;
                               -fx-border-color: transparent;
                               -fx-border-width: 0;
                               -fx-text-fill: #222;
                               -fx-background-radius: 22;
                               -fx-font-size: 15;
                               -fx-focus-color: transparent;
                               -fx-faint-focus-color: transparent;"/>
            </HBox>

        </GridPane>
    </top>

    <!-- ================= CONTENIDO PRINCIPAL (CENTRADO) ================= -->
    <center>
        <GridPane hgap="48"
                  alignment="TOP_CENTER"
                  style="-fx-padding: 36;"
                  maxWidth="1400">

            <columnConstraints>
                <ColumnConstraints percentWidth="50" hgrow="ALWAYS"/>
                <ColumnConstraints percentWidth="50" hgrow="ALWAYS"/>
            </columnConstraints>

            <!-- Panel Izquierdo -->
            <VBox fx:id="actividadesComunidadBox"
                  GridPane.columnIndex="0"
                  spacing="20"
                  alignment="TOP_CENTER"
                  minWidth="0">

                <Label text="Actividades de la Comunidad"
                       style="-fx-font-size: 20;
                              -fx-text-fill: #1563e2;
                              -fx-font-weight: bold;"/>

                <ScrollPane fx:id="scrollActividadesComunidad"
                            fitToWidth="true"
                            fitToHeight="true"
                            hbarPolicy="NEVER"
                            vbarPolicy="AS_NEEDED"
                            style="-fx-background-color: transparent;"
                            VBox.vgrow="ALWAYS">
                    <content>
                        <VBox fx:id="contenedorComunidad"
                              spacing="17"
                              alignment="TOP_CENTER"
                              style="-fx-padding: 6;"/>
                    </content>
                </ScrollPane>
            </VBox>

            <!-- Panel Derecho -->
            <VBox fx:id="actividadesUsuarioBox"
                  GridPane.columnIndex="1"
                  spacing="20"
                  alignment="TOP_CENTER"
                  minWidth="0">

                <Label fx:id="lblTituloPanelDerecho"
                       text="Mis Actividades Creadas"
                       style="-fx-font-size: 20;
                              -fx-text-fill: #1563e2;
                              -fx-font-weight: bold;"/>

                <StackPane VBox.vgrow="ALWAYS" maxWidth="Infinity">

                    <Label fx:id="lblNoSesion"
                           text="Inicia sesiÃ³n para ver tus actividades"
                           alignment="CENTER"
                           style="-fx-font-size: 16;
                                  -fx-text-fill: #999;"/>

                    <ScrollPane fx:id="scrollActividadesUsuario"
                                fitToWidth="true"
                                fitToHeight="true"
                                visible="false"
                                hbarPolicy="NEVER"
                                vbarPolicy="AS_NEEDED"
                                style="-fx-background-color: transparent;"
                                VBox.vgrow="ALWAYS">
                        <content>
                            <VBox fx:id="contenedorUsuario"
                                  spacing="17"
                                  alignment="TOP_CENTER"
                                  style="-fx-padding: 6;"/>
                        </content>
                    </ScrollPane>

                </StackPane>
            </VBox>

        </GridPane>
    </center>

</BorderPane>
